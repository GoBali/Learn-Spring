spring:
  application:
    name: learn-spring
  profiles:
    active: dev
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://springboot-db:5432/learn-spring}
    username: ${SPRING_DATASOURCE_USERNAME:user}
    password: ${SPRING_DATASOURCE_PASSWORD:password}
    type: com.zaxxer.hikari.HikariDataSource
    driver-class-name: org.postgresql.Driver
    hikari:
      connection-timeout: 30000       # 30초 (기본값과 동일)
      pool-name: LearnSpringHikariCP  # 기존 설정 유지
      maximum-pool-size: 10          # 기존 설정 유지
      minimum-idle: 5                # 최소 유휴 연결 수 설정
      idle-timeout: 600000          # 10분 (유휴 연결 제거 시간)
      max-lifetime: 1800000        # 30분 (연결 최대 수명)
      auto-commit: true            # 자동 커밋 설정
      connection-test-query: SELECT 1  # 연결 유효성 검사 쿼리
      leak-detection-threshold: 60000  # 1분 (연결 누수 탐지 임계값)

  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: update
      naming:
        physical-strategy: org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
    open-in-view: false
    properties:
      hibernate:
        globally_quoted_identifiers: true

  security:
    user:
      name: admin
      password: admin

server:
  port: 8443
  ssl:
    enabled: true
    key-store: classpath:localhost.p12
    key-store-password: changeit
    key-store-type: PKCS12

logging:
  level:
    com.zaxxer.hikari: DEBUG
    org.springframework.cache: DEBUG

jasypt:
  encryptor:
    password: learn-spring-encryption-key
    algorithm: PBEWithHMACSHA512AndAES_256
    iv-generator-classname: org.jasypt.iv.RandomIvGenerator

management:
  tracing:
    sampling:
      probability: 1.0
    enabled: true

  zipkin:
    tracing:
      endpoint: http://zipkin-tracer:9411/api/v2/spans

encryption:
  key: learn-spring-secure-data

springdoc:
  api-docs:
    enabled: true
    path: /v3/api-docs

  swagger-ui:
    enabled: true
    path: /swagger-ui.html

#spring:
#  liquibase:
#    enabled: true
#    change-log: classpath:/db/changelog/db.changelog-master.yaml